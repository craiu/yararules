
rule exploit_CVE_2024_6387 {

meta:

	author = "Costin G. Raiu, TLPBLACK, craiu@noh.ro"
	version = "1.0"
	reference = "https://github.com/zgzhang/cve-2024-6387-poc/tree/main"
	hash = "62b06a6c30a0c891c2246ff87c0ad9ae03d2123601ba5331d6348c43b38d185e"
	description = "Strings from CVE-2024-6387 exploit PoC by zgzhang."
	date = "2024-07-02"

strings:
	$a0="Attempting exploitation with glibc base: 0x%lx" ascii wide fullword
	$a1="Attempt %d of 20000" ascii wide fullword
	$a2="Failed to establish connection, attempt %d" ascii wide fullword
	$a3="SSH handshake failed, attempt %d" ascii wide fullword
	$a4="Possible exploitation success on attempt %d with glibc base 0x%lx!" ascii wide fullword
	$a5="Received SSH version: %s" ascii wide fullword
	$a6="Connection closed while receiving SSH version" ascii wide fullword
	$a7="Received KEX_INIT (%zd bytes)" ascii wide fullword
	$a8="Connection closed while receiving KEX_INIT" ascii wide fullword
	$a9="Estimated parsing time: %.6f seconds" ascii wide fullword
	$a10="Received response after exploit attempt (%zd bytes)" ascii wide fullword
	$a11="Possible hit on 'large' race window" ascii wide fullword
	$a12="Connection closed by server - possible successful exploitation" ascii wide fullword
	$a13="No immediate response from server - possible successful exploitation" ascii wide fullword
	$a14="Attempt %d of 10000" ascii wide fullword


condition:

	(filesize<5MB)
	and
	(uint32be(0)==0x7F454C46)
	and
	(4 of ($a*)) 
}
